<!DOCTYPE html>
<html>
    <head>
        <title>CanvasLongShadow Fancy Demo</title>
    </head>
    <body>
        <canvas id="canvas" width="500" height="500"></canvas>

        <script src="../canvas-long-shadow.js"></script>
        <script>
            (function () {
                var canvas = document.getElementById('canvas');

                var shapeShadowRenderer = new CanvasLongShadow.Renderer({
                    width: canvas.width,
                    height: canvas.height
                });

                var iconShadowRenderer = new CanvasLongShadow.Renderer({
                    width: 300,
                    height: 300
                });

                var patternImage = createPatternImage();

                var ctx = canvas.getContext('2d');
                ctx.fillStyle = '#195A72';
                ctx.fillRect(0, 0, canvas.width, canvas.height);

                shapeShadowRenderer.draw(ctx, {
                    fillOriginX: canvas.width / 2,
                    fillOriginY: canvas.width / 2,
                    fillRotationDeg: -45,

                    angleDeg: 45,

                    shapeRenderer: drawShape,

                    fillStyle: function (fillStyleCtx) {
                        return fillStyleCtx.createPattern(patternImage, 'repeat');
                    }
                });

                shapeShadowRenderer.draw(ctx, {
                    fillOriginX: canvas.width / 2,
                    fillOriginY: canvas.width / 2,

                    angleDeg: 160,

                    shapeRenderer: drawShape,

                    fillStyle: function (ctx) {
                        var gradient = ctx.createLinearGradient(0, 0, 300, 0);
                        gradient.addColorStop(0, 'rgba(0, 0, 0, 0.1)');
                        gradient.addColorStop(1, 'rgba(0, 0, 0, 0.0)');
                        return gradient;
                    }
                });

                ctx.fillStyle = '#33B5E5';
                ctx.shadowColor = 'rgba(0, 0, 0, 0.1)';
                ctx.shadowBlur = 20;
                drawShape(ctx);

                ctx.fillStyle = '#FFFFFF';
                ctx.translate(canvas.width / 2, canvas.height / 2);

                ctx.save();
                ctx.translate(-150, -150);
                ctx.clip();

                iconShadowRenderer.draw(ctx, {
                    fillOriginX: 150,
                    fillOriginY: 150,

                    angleDeg: 45,

                    shapeRenderer: function (ctx) {
                        ctx.translate(150, 150);
                        drawIcon(ctx);
                    },

                    fillStyle: function (ctx) {
                        var gradient = ctx.createLinearGradient(50, 0, 150, 0);
                        gradient.addColorStop(0, 'rgba(0, 0, 0, 0.2)');
                        gradient.addColorStop(1, 'rgba(0, 0, 0, 0.0)');
                        return gradient;
                    }
                });

                iconShadowRenderer.draw(ctx, {
                    fillOriginX: 150,
                    fillOriginY: 150,

                    angleDeg: 160,

                    shapeRenderer: function (ctx) {
                        ctx.translate(150, 150);
                        drawIcon(ctx);
                    },

                    fillStyle: function (ctx) {
                        var gradient = ctx.createLinearGradient(50, 0, 150, 0);
                        gradient.addColorStop(0, 'rgba(0, 0, 0, 0.1)');
                        gradient.addColorStop(1, 'rgba(0, 0, 0, 0.0)');
                        return gradient;
                    }
                });

                ctx.restore();
                drawIcon(ctx);

                function drawShape(ctx) {
                    fillRoundedRect(ctx, 100, 100, 300, 300, 20);
                }

                function drawIcon(ctx) {
                    ctx.scale(200, 200);
                    fillBiohazardSymbol(ctx);
                }

                function createPatternImage() {
                    var canvas = document.createElement('canvas');
                    canvas.width = 10;
                    canvas.height = 10;

                    var ctx = canvas.getContext('2d');
                    ctx.lineWidth = 2;
                    ctx.lineCap = 'square';
                    ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
                    ctx.beginPath();

                    for (var i = 0; i < 4; ++i) {
                        ctx.moveTo(5 * i, 0);
                        ctx.lineTo(5 * i - 5, 10);
                    }

                    ctx.stroke();

                    return canvas;
                }

                function fillRoundedRect(ctx, x, y, width, height, radius) {
                    ctx.beginPath();
                    ctx.moveTo(x + radius, y);
                    ctx.lineTo(x + width - radius, y);
                    ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
                    ctx.lineTo(x + width, y + height - radius);
                    ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
                    ctx.lineTo(x + radius, y + height);
                    ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
                    ctx.lineTo(x, y + radius);
                    ctx.quadraticCurveTo(x, y, x + radius, y);
                    ctx.closePath();
                    ctx.fill();
                }

                function fillBiohazardSymbol(ctx) {
                    // generated -- do not touch
                    ctx.save();
                    ctx.scale(1 / 331, 1 / 331);
                    ctx.translate(-331 / 2, -175.5);
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(0,0);
                    ctx.lineTo(331,0);
                    ctx.lineTo(331,314);
                    ctx.lineTo(0,314);
                    ctx.closePath();
                    ctx.clip();
                    ctx.translate(0,0);
                    ctx.translate(0,0);
                    ctx.scale(1,1);
                    ctx.translate(-0.001,0);
                    ctx.strokeStyle = 'rgba(0,0,0,0)';
                    ctx.lineCap = 'butt';
                    ctx.lineJoin = 'miter';
                    ctx.miterLimit = 4;
                    ctx.save();
                    ctx.restore();
                    ctx.save();
                    ctx.restore();
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(75.33,165.564);
                    ctx.bezierCurveTo(73.16199999999999,186.09699999999998,78.098,207.04899999999998,89.326,224.384);
                    ctx.bezierCurveTo(94.43199999999999,232.26799999999997,100.76599999999999,239.34799999999998,108.03099999999999,245.302);
                    ctx.bezierCurveTo(111.66999999999999,248.285,115.541,250.986,119.59799999999998,253.369);
                    ctx.bezierCurveTo(121.63699999999999,254.566,123.72399999999999,255.684,125.85099999999998,256.72);
                    ctx.bezierCurveTo(126.91799999999998,257.24,127.99699999999999,257.738,129.083,258.21400000000006);
                    ctx.bezierCurveTo(130.984,259.04800000000006,131.595,256.39000000000004,132.435,254.82100000000005);
                    ctx.bezierCurveTo(135.239,249.59200000000004,137.27,243.95600000000005,138.449,238.14000000000004);
                    ctx.bezierCurveTo(138.787,236.47700000000003,139.595,235.52500000000003,137.89200000000002,234.73600000000005);
                    ctx.bezierCurveTo(136.824,234.24200000000005,135.76900000000003,233.71700000000004,134.73000000000002,233.16700000000006);
                    ctx.bezierCurveTo(132.66000000000003,232.06700000000006,130.64800000000002,230.85800000000006,128.70700000000002,229.54600000000005);
                    ctx.bezierCurveTo(120.64800000000002,224.09400000000005,113.83200000000002,216.85100000000006,108.88500000000002,208.47200000000004);
                    ctx.bezierCurveTo(104.01800000000001,200.22700000000003,101.00700000000002,190.93300000000005,100.11200000000002,181.40100000000004);
                    ctx.bezierCurveTo(99.87200000000003,178.83900000000003,99.77600000000002,176.26100000000005,99.84100000000002,173.68800000000005);
                    ctx.bezierCurveTo(99.87800000000003,172.20400000000004,99.97000000000003,170.71800000000005,100.10300000000002,169.23800000000006);
                    ctx.bezierCurveTo(98.62800000000003,168.69200000000006,97.13200000000002,168.20400000000006,95.61900000000003,167.77300000000005);
                    ctx.bezierCurveTo(89.041,165.905,82.153,165.155,75.33,165.564);
                    ctx.moveTo(127.14,121.929);
                    ctx.bezierCurveTo(143.994,109.792,166.153,106.355,185.892,112.845);
                    ctx.bezierCurveTo(190.56799999999998,114.382,195.066,116.452,199.279,118.997);
                    ctx.bezierCurveTo(201.095,120.095,203.039,122.528,204.791,121.031);
                    ctx.bezierCurveTo(206.918,119.21600000000001,208.92,117.253,210.775,115.162);
                    ctx.bezierCurveTo(214.192,111.313,217.119,107.031,219.461,102.45);
                    ctx.bezierCurveTo(215.13500000000002,99.23100000000001,210.52300000000002,96.398,205.693,93.999);
                    ctx.bezierCurveTo(186.847,84.634,164.892,82.169,144.42200000000003,87.029);
                    ctx.bezierCurveTo(134.69600000000003,89.34,125.37500000000003,93.283,116.93600000000002,98.639);
                    ctx.bezierCurveTo(115.04400000000003,99.83999999999999,113.19700000000002,101.112,111.39900000000002,102.451);
                    ctx.bezierCurveTo(112.67800000000001,104.955,114.13300000000001,107.371,115.74700000000001,109.67399999999999);
                    ctx.bezierCurveTo(118.957,114.256,122.801,118.393,127.14,121.929);
                    ctx.moveTo(192.411,234.988);
                    ctx.bezierCurveTo(193.358,240.841,195.167,246.55,197.757,251.881);
                    ctx.bezierCurveTo(198.645,253.703,200.423,258.819,202.507,257.883);
                    ctx.bezierCurveTo(204.677,256.907,206.81,255.84799999999998,208.897,254.70499999999998);
                    ctx.bezierCurveTo(217.51999999999998,249.98,225.35999999999999,243.84699999999998,232.03,236.62199999999999);
                    ctx.bezierCurveTo(245.356,222.184,253.736,203.536,255.619,183.974);
                    ctx.bezierCurveTo(256.139,178.572,256.176,173.123,255.728,167.713);
                    ctx.bezierCurveTo(255.565,165.74099999999999,256.207,164.769,253.946,164.70999999999998);
                    ctx.bezierCurveTo(252.459,164.67,250.968,164.68599999999998,249.481,164.75499999999997);
                    ctx.bezierCurveTo(246.51999999999998,164.89399999999998,243.569,165.24999999999997,240.662,165.81799999999996);
                    ctx.bezierCurveTo(237.758,166.38499999999996,234.893,167.16499999999996,232.103,168.14799999999997);
                    ctx.bezierCurveTo(229.947,168.90899999999996,230.852,169.86999999999998,230.95700000000002,171.90299999999996);
                    ctx.bezierCurveTo(231.032,173.42099999999996,231.05700000000002,174.93699999999995,231.026,176.45599999999996);
                    ctx.bezierCurveTo(230.925,181.79799999999997,230.17700000000002,187.12599999999995,228.78900000000002,192.28499999999997);
                    ctx.bezierCurveTo(223.724,211.08,210.143,226.975,192.411,234.988);
                    ctx.moveTo(22.373,193.256);
                    ctx.bezierCurveTo(43.128,156.755,94.373,149.389,124.741,178.318);
                    ctx.bezierCurveTo(125.673,179.20700000000002,134.446,189.24200000000002,134.128,189.425);
                    ctx.bezierCurveTo(136.28699999999998,188.178,138.445,186.93200000000002,140.606,185.686);
                    ctx.bezierCurveTo(143.028,184.28900000000002,145.45,182.889,147.873,181.49200000000002);
                    ctx.bezierCurveTo(149.20999999999998,180.72000000000003,148.07299999999998,179.62,147.827,178.22000000000003);
                    ctx.bezierCurveTo(147.316,175.32300000000004,147.548,172.30300000000003,148.482,169.51400000000004);
                    ctx.bezierCurveTo(149.899,165.28800000000004,152.921,161.68400000000003,156.825,159.53700000000003);
                    ctx.bezierCurveTo(157.29999999999998,159.27500000000003,162.10799999999998,157.51000000000005,162.10799999999998,157.58700000000005);
                    ctx.bezierCurveTo(162.10799999999998,156.62900000000005,162.10799999999998,155.67100000000005,162.10799999999998,154.71400000000006);
                    ctx.bezierCurveTo(162.10799999999998,151.56800000000007,162.10799999999998,148.42500000000007,162.10799999999998,145.27900000000005);
                    ctx.bezierCurveTo(162.10799999999998,144.10700000000006,162.10799999999998,142.93600000000006,162.10799999999998,141.76400000000007);
                    ctx.bezierCurveTo(162.10799999999998,140.05000000000007,159.33799999999997,140.77100000000007,157.962,140.61500000000007);
                    ctx.bezierCurveTo(121.88,136.52400000000006,95.73899999999999,102.72400000000007,100.273,66.87900000000006);
                    ctx.bezierCurveTo(102.318,50.72100000000006,110.619,35.64300000000006,123.047,25.14200000000006);
                    ctx.bezierCurveTo(130.661,18.70900000000006,139.724,14.04500000000006,149.394,11.621000000000059);
                    ctx.bezierCurveTo(151.86100000000002,11.00200000000006,150.88,8.413000000000059,150.88,6.036000000000059);
                    ctx.bezierCurveTo(150.88,4.0240000000000595,150.88,2.0130000000000594,150.88,0.0020000000000592877);
                    ctx.bezierCurveTo(113.002,5.570000000000059,80.919,33.56400000000006,70.214,70.31500000000005);
                    ctx.bezierCurveTo(67.439,79.84600000000006,66.124,89.78800000000005,66.28399999999999,99.71100000000006);
                    ctx.bezierCurveTo(66.386,106.05100000000006,67.091,112.38000000000005,68.395,118.58600000000006);
                    ctx.bezierCurveTo(68.881,120.90100000000005,67.88499999999999,120.35900000000005,65.92399999999999,121.05900000000005);
                    ctx.bezierCurveTo(64.52199999999999,121.55800000000005,63.13099999999999,122.08900000000006,61.751999999999995,122.65000000000005);
                    ctx.bezierCurveTo(58.49099999999999,123.97900000000004,55.300999999999995,125.48200000000004,52.199,127.14800000000005);
                    ctx.bezierCurveTo(34.732,136.53300000000004,20.301,151.09400000000005,11.153999999999996,168.69200000000006);
                    ctx.bezierCurveTo(-1.9970000000000034,194.00100000000006,-3.6430000000000042,224.42700000000008,6.878999999999996,250.95600000000007);
                    ctx.bezierCurveTo(9.664999999999996,249.34800000000007,12.450999999999997,247.73800000000008,15.237999999999996,246.13100000000009);
                    ctx.bezierCurveTo(17.255999999999997,244.9670000000001,16.454999999999995,244.92000000000007,15.796999999999995,242.38700000000009);
                    ctx.bezierCurveTo(14.660999999999996,238.0190000000001,13.980999999999995,233.53300000000007,13.769999999999996,229.0270000000001);
                    ctx.bezierCurveTo(13,216.695,16.254,203.943,22.373,193.256);
                    ctx.moveTo(287.431,280.387);
                    ctx.bezierCurveTo(270.245,290.848,249.69,293.876,230.46599999999998,287.227);
                    ctx.bezierCurveTo(211.24699999999999,280.609,195.95,265.07399999999996,189.55399999999997,245.79099999999997);
                    ctx.bezierCurveTo(185.96599999999998,234.96499999999997,185.23999999999998,223.21999999999997,187.50099999999998,212.04099999999997);
                    ctx.bezierCurveTo(188.688,206.18499999999997,190.68599999999998,200.49799999999996,193.41099999999997,195.18199999999996);
                    ctx.bezierCurveTo(192.93899999999996,194.04099999999997,188.66299999999998,192.43999999999997,187.62199999999999,191.83899999999997);
                    ctx.bezierCurveTo(185.093,190.37699999999998,182.55999999999997,188.91599999999997,180.03099999999998,187.45499999999998);
                    ctx.bezierCurveTo(178.86199999999997,186.77999999999997,179.218,186.63799999999998,178.10899999999998,187.759);
                    ctx.bezierCurveTo(176.03099999999998,189.85799999999998,173.439,191.432,170.61299999999997,192.291);
                    ctx.bezierCurveTo(165.59699999999998,193.815,160.03899999999996,193.019,155.65599999999998,190.141);
                    ctx.bezierCurveTo(155.07899999999998,189.762,151.96699999999998,186.797,151.71099999999998,186.944);
                    ctx.bezierCurveTo(150.73399999999998,187.50799999999998,149.75799999999998,188.07299999999998,148.78099999999998,188.636);
                    ctx.bezierCurveTo(146.05199999999996,190.21099999999998,143.32199999999997,191.787,140.593,193.364);
                    ctx.bezierCurveTo(139.69,193.885,138.786,194.407,137.88299999999998,194.928);
                    ctx.bezierCurveTo(136.95799999999997,195.46099999999998,139.09599999999998,198.409,139.47699999999998,199.268);
                    ctx.bezierCurveTo(144.43699999999998,210.429,146.16699999999997,222.901,144.46299999999997,234.994);
                    ctx.bezierCurveTo(141.91899999999995,253.046,131.73399999999998,269.727,116.64499999999997,280.012);
                    ctx.bezierCurveTo(100.37199999999997,291.103,79.79499999999996,294.474,60.855999999999966,288.908);
                    ctx.bezierCurveTo(51.33099999999997,286.099,42.48299999999996,281.149,35.142999999999965,274.458);
                    ctx.bezierCurveTo(34.523999999999965,273.894,31.478999999999964,270.355,30.935999999999964,270.67);
                    ctx.bezierCurveTo(29.961999999999964,271.232,28.988999999999965,271.79400000000004,28.015999999999963,272.356);
                    ctx.bezierCurveTo(25.820999999999962,273.625,23.623999999999963,274.89,21.42799999999996,276.158);
                    ctx.bezierCurveTo(46.480999999999966,307.805,89.73499999999996,321.214,128.29899999999995,309.298);
                    ctx.bezierCurveTo(138.64299999999994,306.102,148.45399999999995,301.193,157.22999999999996,294.853);
                    ctx.bezierCurveTo(159.54699999999997,293.17900000000003,161.79299999999995,291.406,163.95699999999997,289.539);
                    ctx.bezierCurveTo(165.42599999999996,288.271,165.48899999999998,287.166,167.15299999999996,288.60699999999997);
                    ctx.bezierCurveTo(168.24299999999997,289.551,169.35399999999996,290.47299999999996,170.48499999999996,291.371);
                    ctx.bezierCurveTo(175.30699999999996,295.19599999999997,180.48699999999997,298.57099999999997,185.92999999999995,301.447);
                    ctx.bezierCurveTo(203.72899999999996,310.851,224.22099999999995,314.629,244.20099999999996,312.175);
                    ctx.bezierCurveTo(269.88899999999995,309.021,293.799,295.693,309.871,275.39);
                    ctx.bezierCurveTo(307.084,273.782,304.299,272.173,301.512,270.565);
                    ctx.bezierCurveTo(299.297,269.287,298.991,271.018,297.174,272.745);
                    ctx.bezierCurveTo(294.179,275.589,290.911,278.152,287.431,280.387);
                    ctx.moveTo(281.776,127.865);
                    ctx.bezierCurveTo(277.79200000000003,125.565,273.648,123.53999999999999,269.38300000000004,121.81);
                    ctx.bezierCurveTo(267.06100000000004,120.869,264.701,120.014,262.31500000000005,119.25);
                    ctx.bezierCurveTo(262.84700000000004,116.801,263.28800000000007,114.331,263.63300000000004,111.849);
                    ctx.bezierCurveTo(264.81500000000005,103.364,264.89700000000005,94.72500000000001,263.88100000000003,86.218);
                    ctx.bezierCurveTo(262.16200000000003,71.822,257.242,57.871,249.55300000000003,45.580000000000005);
                    ctx.bezierCurveTo(234.267,21.145,208.513,4.195,179.978,0);
                    ctx.bezierCurveTo(179.978,2.276,179.978,4.554,179.978,6.831);
                    ctx.bezierCurveTo(179.978,8.101,179.978,9.371,179.978,10.641);
                    ctx.bezierCurveTo(179.978,12.016,184.568,12.466,185.847,12.883);
                    ctx.bezierCurveTo(195.654,16.086,204.669,21.637999999999998,211.947,28.951999999999998);
                    ctx.bezierCurveTo(225.959,43.035,232.973,63.053999999999995,230.707,82.798);
                    ctx.bezierCurveTo(228.67,100.751,219.071,117.29599999999999,204.582,128.08100000000002);
                    ctx.bezierCurveTo(195.707,134.686,185.197,138.985,174.23,140.45800000000003);
                    ctx.bezierCurveTo(173.53699999999998,140.55100000000002,168.75,140.80400000000003,168.75,141.17300000000003);
                    ctx.bezierCurveTo(168.75,142.07800000000003,168.75,142.98200000000003,168.75,143.88600000000002);
                    ctx.bezierCurveTo(168.75,147.27,168.75,150.65400000000002,168.75,154.038);
                    ctx.bezierCurveTo(168.75,155.083,168.75,156.12900000000002,168.75,157.174);
                    ctx.bezierCurveTo(168.75,158.18200000000002,171.151,158.244,172.016,158.586);
                    ctx.bezierCurveTo(176.50799999999998,160.36700000000002,180.16199999999998,163.983,181.988,168.46);
                    ctx.bezierCurveTo(182.857,170.592,183.301,172.888,183.301,175.18900000000002);
                    ctx.bezierCurveTo(183.301,175.95100000000002,182.289,181.086,182.469,181.19100000000003);
                    ctx.bezierCurveTo(184.817,182.54500000000004,187.164,183.90100000000004,189.512,185.25600000000003);
                    ctx.bezierCurveTo(191.785,186.56900000000002,194.059,187.88200000000003,196.332,189.19400000000002);
                    ctx.bezierCurveTo(196.778,189.453,203.885,180.21900000000002,205.082,179.00400000000002);
                    ctx.bezierCurveTo(212.35,171.61300000000003,221.408,165.966,231.266,162.75000000000003);
                    ctx.bezierCurveTo(268.323,150.65600000000003,308.293,173.91500000000002,316.291,212.06100000000004);
                    ctx.bezierCurveTo(318.373,222.30800000000005,317.977,233.01800000000003,315.109,243.07800000000003);
                    ctx.bezierCurveTo(314.421,245.48400000000004,316.445,245.57700000000003,318.507,246.76800000000003);
                    ctx.bezierCurveTo(320.48,247.90700000000004,322.45,249.04500000000002,324.423,250.18400000000003);
                    ctx.bezierCurveTo(342.317,205.065,323.774,152.112,281.776,127.865);
                    ctx.fill();
                    ctx.stroke();
                    ctx.restore();
                    ctx.restore();
                    ctx.restore();
                }
            }());
        </script>
    </body>
</html>
